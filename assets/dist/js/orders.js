(()=>{"use strict";!function(e,t,n){const o=me('select[name="afip-customer-document-type"]'),i=me('select[name="afip-customer-invoice-type"]');i&&i.on("change",(e=>{"1"===e.currentTarget.value&&"96"===o.value&&(o.value="80"),"6"===e.currentTarget.value&&"80"===o.value&&(o.value="96")}));const c=me("#afip_process_order");c&&c.on("click",(()=>{e.sendRequest("POST",`/orders/${n.order_id}/process`,(()=>window.location.reload()),{button:c,body:{options:{name:me('input[name="afip-customer-name"]').value,address:me('input[name="afip-customer-adress"]').value,condition:me('select[name="afip-customer-condition"]').value,document_type:me('select[name="afip-customer-document-type"]').value,document_number:me('input[name="afip-customer-document-number"]').value,invoice_type:me('select[name="afip-customer-invoice-type"]').value}}})}));const r=me("#afip-create-credit-note");r&&r.on("click",(()=>{confirm(t.credite_note_creation_confirmation_text)&&e.sendRequest("POST",`/orders/${n.order_id}/credit-note/create`,(()=>window.location.reload()),{button:r})}));const a=me("#afip-send-invoice-mail");a&&a.on("click",(function(o){e.sendRequest("POST",`/orders/${n.order_id}/mails/invoice/send`,(()=>e.addNotice(t.mail_sent)),{button:a})}));const d=me("#afip-send-credit-note-mail");d&&d.on("click",(function(o){e.sendRequest("POST",`/orders/${n.order_id}/mails/credit-note/send`,(()=>e.addNotice(t.mail_sent)),{button:d})}));const s=me("#afip-view-invoice");let u="",p="";s&&s.on("click",(function(o){p&&!p.closed?p.focus():u?p=e.popupWithIframe(u,t.afip_invoice):e.sendRequest("GET",`/orders/${n.order_id}/invoice`,(n=>{if(!n.content)return void e.addNotice(t.generic_error_try_again,"error");let o=e.b64ToBlob(n.content,"application/pdf");u=URL.createObjectURL(o),p=e.popupWithIframe(u,t.afip_invoice)}),{button:s})}));const l=me("#afip-view-credit-note");let m="",f="";l&&l.on("click",(function(o){f&&!f.closed?f.focus():m?f=e.popupWithIframe(m,t.afip_credit_note):e.sendRequest("GET",`/orders/${n.order_id}/credit-note`,(n=>{if(!n.content)return void e.addNotice(t.generic_error_try_again,"error");let o=e.b64ToBlob(n.content,"application/pdf");m=URL.createObjectURL(o),f=e.popupWithIframe(m,t.afip_credit_note)}),{button:l})}));const _=me("#afip-download-invoice");let v="";_&&_.on("click",(function(o){v?v.dispatchEvent(new MouseEvent("click")):e.sendRequest("GET",`/orders/${n.order_id}/invoice`,(o=>{o.content?(v=document.createElement("a"),v.download=`AFIP-${n.order_id}-${n.invoice_cae}.pdf`,v.href="data:application/pdf;base64,"+o.content,v.dispatchEvent(new MouseEvent("click"))):e.addNotice(t.generic_error_try_again,"error")}),{button:_})}));const b=me("#afip-download-credit-note");let w="";b&&b.on("click",(function(o){w?w.dispatchEvent(new MouseEvent("click")):e.sendRequest("GET",`/orders/${n.order_id}/credit-note`,(o=>{o.content?(w=document.createElement("a"),w.download=`AFIP-${n.order_id}-${n.credit_note_cae}.pdf`,w.href="data:application/pdf;base64,"+o.content,w.dispatchEvent(new MouseEvent("click"))):e.addNotice(t.generic_error_try_again,"error")}),{button:b})}))}(afipHelper,wc_afip_translation_texts,wc_afip_settings)})();