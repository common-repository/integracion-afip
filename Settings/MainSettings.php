<?php

namespace CRPlugins\Afip\Settings;

defined( 'ABSPATH' ) || exit;

class MainSettings {

	public function __construct() {
		add_action( 'admin_init', array( __CLASS__, 'init_settings' ) );
		add_action( 'admin_menu', array( $this, 'create_menu_option' ) );
		add_action( 'admin_enqueue_scripts', array( $this, 'add_assets_files' ) );
	}

	public static function init_settings(): void {
		register_setting( 'wc-afip', 'wc-afip_options' );
	}

	public function add_assets_files( string $hook ): void {
		if ( 'toplevel_page_wc-afip-admin' === $hook ) {
			wp_enqueue_script( 'wc-afip-settings-js' );
			wp_localize_script(
				'wc-afip-settings-js',
				'wc_afip_settings',
				array(
					'store_url' => get_site_url(),
					'nonce'     => wp_create_nonce( 'wp_rest' ),
				)
			);
		}
	}

	public function create_menu_option(): void {
		add_menu_page(
			'AFIP',
			'AFIP',
			'manage_options',
			'wc-afip-admin',
			array( __CLASS__, 'settings_page_content' ),
			'data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDE2NSAxMzIiIHdpZHRoPSIxNjUiIGhlaWdodD0iMTMyIj48ZGVmcz48aW1hZ2UgIHdpZHRoPSIxNjQiIGhlaWdodD0iMTMwIiBpZD0iaW1nMSIgaHJlZj0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFLUUFBQUNDQ0FNQUFBRC9ucE5ZQUFBQUFYTlNSMElCMmNrc2Z3QUFBb3RRVEZSRlpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFacmphWnJqYVpyamFDTjNyRXdBQUFObDBVazVUQURaQUp0ai8zUzYzNmZXaXdNTDBDeEpEYjRtWXByVytzcVdMZFF4Y3M5T2hZZzRQdmF5YWhtb2NPcC96V2hUdnJpVUNWc255Y2dScDRkbEJGZU5SS3NjUnNJcmxQZWMveVAyQTlqSW8zN25ySURmeDV0SEQyNm5rdjg4R0pNRjBTUjROY0xUM2xwTVFlODZOMm5vZENWVjk0UHNmeFR3dnpkQ2NmL2tXL2x0WHVJTlExN3BlQlh3cDdtZHNURVkwZUFId0dzWmpuaGxZb3dkVE5hMDVDS0M3TFpuU0dDTXdjNnFiVW9LQnE0K1JBMG8rYnNUOFlUdHg3WTdWVFN1eEYrelUrbDJNNm1YTTNDR0Z0dmc0Q21oZldjcVhSS2VIWnBNQ3NKb0FBQWRjU1VSQlZIaWM3Wng1VUpaRkhNZDNCOVF4YTlETXhxZzhPeEFUa0pTMEVMd0c3d0h4bUVoUlFWSXJrOHlRVVZJT1R3UU1sQVFQQmpSUGNEQlV4aHhURzBkenN2S3N6Qmt0TWgwMU01czhHelRqZVlsbmYvdThlejJQVDhuYlBOOC9YdmI4dlo5M2QzKzd6KzZ6QTBZSVlZenFzZkJkcFBGNTEydkltamIwQUVqazVRbVEzcDRBMmNCaklKdlVXMGg4Vy90c1hHLzVYUEs1cVgwMmNDRHZXdzZrWFhJZzdaSURhWmNjU0x2a1FOb2xCOUl1T1pCMnlZRzBTdzZrWFhJZzdaSVNaRk5jcCtxRytHYVRjLzhKR1pBYzhtbDgrUTZkNGx0RCs0UFFhdnRMek9TVzJ1KzgxUEtrT1VRcHBEL0dwNWdaelZ0Y0ZUUm9nSkRESDU5dGZVUU5yMVlpeUdDTWovRnJCbUg4QlM5UERLa3AwUHVjK3FnUlFIYkRYNG5yZHNVSE9EbWhYSHhvZnArOFVLMjRrT0ZjQXFDbUwreGxwc3RiVWxPUGUremFidUpCOWxIN21lRjRGeXRaRFJMMXdqdVZ5ckVoQTN4M0s5VkdxQysrZU5nOVZhVzdOVVhnN1NyRm1KQkQ4QTYxTDlFMHNNSTlUYkVsRVJxRXR5aVVZa0ZHNDYyTWtwSGE3SGlVa1RGc28xc1NhTW5od1BTZDhvN2ZHVXFPeEdzdFFjWWVOMXFLcWVFcmRvWGlUL2xoWEdMSWpsdGh0QXBhTW40NWxUTnAwNnQ0SlV5WThLRVZ5S2FqYWJNVE1WNUNKU1RpRGIvUlJpWi9ZTEFLV3RJQXFXbndjMHRKWkFyT3RnQ1psQXZ6bTQxYnhLaVZqSE9vZUloaHVoSkRvdEFlQUN4cHZubklGQWpWNjhyWG5IcStsMkVzOHJGQ001QW9vQTN4ek9ScmVXWWhPL2NHZlJ2bE40ZGJzVzNzQWhCcmZ0RVVKRXBlVE1JQnZJYmdRc0xPN3RPbTBMMkNybFNxbTFMU1lJenZPSFZLbjZzSEc5NHdDVGwyUGNtNjEwcjhQSllCbTNsaVBzeVN0aVNhazZFSFU5ODNCOW4rOGkwOUo4anZJMG5kZVdrZ2tqN1RGS1JQZ2o2cytvYk5NQVc1Y0JiSjZTNWR2ZU84UzBpRWFrbzVKSnBCSEh4dXNobklwNmFrNkJsalY4a1lFY3BLQjVGV1lBbFFnRXhZclFlbnNtWTVMbVEyYVBjM2xqRExxMG51T0tqTmVUMjRjSnJFSEFYWms4ekpQcjlhNUhOSm9TV0R2dFdEbWU5S3pFSElEcWYxNUJrblZKNU91RktBSEVtK1lORlVpVGtJbVp1a0o2dU1TSUhrM1oySFNSOHZmbHRpRGtMbWsxK1UrNVpsUUUzeWxweE9ua2tpS21YbUFHVHc5OVY2Y29mamxnRTF5VnR5V2FJZVRFdGhsZ0FDa0VNKzBWTkhyclBNNTVJVXN1QTBtVHdlUDg4cUFRVWdDOG5ReUo5b0hWQ1RyTHNYbk54QUlzOUk5eG9BOG5teVZFOWF5aXV2SmtsTHJzaXFJaEY1YjBOSU1FeVd2VzZaenlVeFpLTlpjS1VxU0pDYUE1QkZrL1RVNWZIV0FUVUpJSXRYbmJrQzR5dkh5YzBCeU5Ya0p4V05zUTZvQ1l6SndINGt1VkhiNHBlT2ZrcVZiQkM4M3hSa0YzSTZOZmkrMWhzVCsyNDBQMGxlQmtLdWpkTlRTMGFaNXFLa2VvS0I4dDVVS1FVZ3dZS3oralhUWEpSVVc3TFpMMHJGQUNUWWRxeUpNYzFGU2EwbHgvVlp4RGhIWWdoQWJocXRwMG9mUXlWU2Fza1JYckw5U1owQVpDa1ppUFRlejd3VVdqSjYrQWhsY3dCeU0rbmpqY1BNZzBISlduS1EvODFjY1FsS0FMS01lTXVtYUF0a1FCTEkwcUhtekFISTk4aHh4d0RXMlo4SmdlNHVpNnI5MitzNk9UWU0rdFBja3lCODZBMGsrNzMrMjZ3VElpWWtHcitHNUt1c2hVQVFFc3hCblE5WnhLc1ZDN0ppZlRrcG9QQlVBUVFodTVHVG8ya0xMUU5xWWtHaXJjQWJvMFpIbWpBSElRc3VrSU95OGlHV0NSRUhranFXMlRMWWhEbHEzMTFKRE43ZmRwRU5HUnREbXMrVTcxQ1FqMTRqR1hmL3NrcUllSkRvWXpCL1AxbWxibzQrQytwQ2RwZGRQNWRYM2dFWGpRMWdnSEFnNC8zQVZtRmJmMnVRYUNjWUtlM1lyMmVCMmhVT0lwRncrRERMZ1VSK1owZzR0Wk95N3hnT1VZZUROMGV6WnpIS1ErMGFDQ0xid1JNNEY3S2l5UUFTVWZjZEErVDhWSkxWT0YrOGlkZ04rNnV5RWg3UDh5RFJOckRlcXZ1Tzhjd2NIQnVpeWl1aXg4bzlVYmRBYlBvOG1NZUZSSHNqU0ZoK1dNNkIvQXozSlprNUQvTjNqVGdUN3BkM2gxR1pmTWpZQ2IxSlJOVjMzTjdqaEIyRTJWbnZjT3J0ajZpRzBaMjlxVncrSlBVQ1NOVjMzTitJSGVnSjgxdlBaZzNNTlJrL1VmRXhSWFMrQURJK0laeEVIakc4LzFPR3BJWk5qUXBQR2ZjU1pWdks2SVFuemhwS0NDRFJRVEF5RkgySEFaa1kwNE11cy8vY1ZhKzY3ZTZoYnpwbEdsOXdIK3hpdENxQ3pPc0lwaUUxMzJHOTd3NE56WEVyaHdjY0toaC9ZK2htaGduR2laTUlrcHFHMUh5SGVYUEFwOUZWaGFyL0tNMDN6aTFOQ0ltZXJTSmhKZDloMzhFSXZ2NmpHaUdxT0xCRGZBZURBUmszdVJ1SnFQZ083elpMMmtQeVk4TWFSYzRNWmlXTElkR1hMNU93aXU5dzd3V3RxMHFUVmtZTlE5ZzNleVNRUjI2QmFVamhWRmx3dytyb1hNWTlGU2l2WXQ2eUtZRkV4K0I4SVBjZDRZVzY0NW1sL0pveFovaFhzR1NRYUJRd0xQY2R5YTIvZmkvbVZyUFNBeThNRTcxN2xFSkd3eTJ6Y2IxeWsvVCtaT0w0a0F6YWh3N2puMHVMeFZhbGtLakY3eVFzOVIybG02anJnazZzUExhdlo5YnRzRmZhdGk0WEZ2MVg5UCs1MC91ZzVVRGFKUWZTTGptUWRzbUJ0RXNPcEYxeUlPMlNBMm1YSEVpNzVFRGFKUWZTTGptUWRzbUJ0RXNBTW52UEEyYmhLdDExNk9yNlIxc2U4Uy9MSEVnYjVPOEprSWM5QWJKNy9mWnVUWXYvQ1BrYmkxNWJ4UnZITUU4QUFBQUFTVVZPUks1Q1lJST0iLz48L2RlZnM+PHN0eWxlPjwvc3R5bGU+PHVzZSAgaHJlZj0iI2ltZzEiIHg9Ii0xIiB5PSIxIi8+PC9zdmc+'
		);
	}

	public static function settings_page_content(): void {

		if ( ! is_admin() || ! current_user_can( 'manage_options' ) ) {
			die( 'what are you doing here?' );
		}

		?>
		<div id="wc-afip-settings-app"></div>
		<?php
	}
}
